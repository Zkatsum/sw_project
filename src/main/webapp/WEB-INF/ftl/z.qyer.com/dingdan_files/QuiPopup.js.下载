define(["web_qui_controlbase","css!web_qui_quipopup"],function(i){"use strict";function t(i){this.init(i)}var o=jQuery;return t.prototype=new i,t.prototype.constructor=t,o.extend(t.prototype,{_$ui:null,_option:{width:400,zIndex:1e3,exClassName:"",isDisableCloseIcon:!1,isDisableTitle:!1,isDisableMask:!1,contentHTML:"",position:{}},setConfig:function(i){if("object"!=typeof i)throw new Error("Parameter error");return this._option=o.extend({},this._option,i),this._updateUI(),this},_updateUI:function(){return this._$ui.css({zIndex:this._option.zIndex})[0].className="qui-popup "+this._option.exClassName,this._$ui.find(".qui-popup-box").css({width:this._option.width}),this._$ui.find(".qui-popup-closeIcon")[this._option.isDisableCloseIcon?"hide":"show"](),this._$ui.find(".qui-popup-box-title")[this._option.isDisableTitle?"hide":"show"](),this._$ui[this._option.isDisableMask?"addClass":"removeClass"]("qui-popup-noMask"),this._option.contentHTML&&this._$ui.find(".qui-popup-box-content").html(this._option.contentHTML),this},_bindEvent:function(){var i=this;this._$ui.on("click",".qui-popup-closeIcon",function(t){i.close(t)})},init:function(i){o.extend(this._option,i),this._create().setConfig(this._option)._bindEvent()},_create:function(){var i='<div class="qui-popup" style="display:none;"><div><div class="qui-popup-box"><div class="qui-popup-box-title borderbox"></div><div class="qui-popup-box-content borderbox"></div><div class="qui-popup-closeIcon">&nbsp;</div></div></div></div>';return this._$ui=o(i),this._$box=this._$ui.find(".qui-popup-box"),this._$ui.appendTo(document.body),this},destroy:function(){this._$ui.off().remove()},_showOption:{},_updateShowOptionUI:function(i){return this._showOption=i||{},this._option.isDisableTitle||this._$ui.find(".qui-popup-box-title").html(i.title||"&nbsp;"),i.contentHTML&&this._$ui.find(".qui-popup-box-content").html(i.contentHTML),"number"==typeof this._showOption.top&&"number"==typeof this._showOption.left?(this._$ui.children("div").css({display:"block",position:"relative"}),this._$ui.find(".qui-popup-box").css({top:this._showOption.top,left:this._showOption.left,position:"absolute"})):(this._$ui.children("div").css("display","table-cell"),this._$ui.find(".qui-popup-box").css({top:0,left:0,position:"relative"})),this},show:function(i){var t=this;if(i=i||{},this._updateShowOptionUI(i),this._$ui.show(),i.position)if(i.position.target){this._$ui.addClass("qui-popup-target");var s=o(i.position.target),n=s[i.position.calc||"offset"](),e=n.left,p=n.top,u=s.outerHeight();this._$ui.appendTo(s.parent());var h=i;h.left=e,h.top=p+u,this._updateShowOptionUI(h)}else this._$ui.removeClass("qui-popup-target"),this._$ui.appendTo(document.body);return setTimeout(function(){t._$ui.css({opacity:1}),t._$box.css({opacity:1,transform:"scale(1)"}),setTimeout(function(){t._showOption.onShow&&t._showOption.onShow(),t=null},310)},0),this},close:function(i,t){if(t===!1||!this._showOption.onClose||this._showOption.onClose(i)!==!1){this._$ui.css({opacity:0}),this._$box.css({opacity:1,transform:"scale(0.85)"});var o=this;setTimeout(function(){o._$ui.css({display:"none"}),o=null},310)}},getDom:function(){return this._$ui[0]},setContent:function(i){this._$ui.find(".qui-popup-box-content").html(i)}}),t});